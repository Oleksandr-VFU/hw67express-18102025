# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫—É—Ä—Å–æ—Ä—ñ–≤ —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ–π–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ —É MongoDB —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä Express

**–ê–≤—Ç–æ—Ä:** –ûleksandr Komnatskyi
**–¢–µ–º–∞:** –ö—É—Ä—Å–æ—Ä–∏ —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ–π–Ω—ñ –∑–∞–ø–∏—Ç–∏ –≤ MongoDB  
**Framework:** Express.js + MongoDB Node.js Driver  

---

## **–û–ø–∏—Å –ø—Ä–æ–µ–∫—Ç—É** üìã

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø—Ä–∞–∫—Ç–∏—á–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **–∫—É—Ä—Å–æ—Ä—ñ–≤ (cursors)** —Ç–∞ **–∞–≥—Ä–µ–≥–∞—Ü—ñ–π–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ (aggregation pipelines)** —É MongoDB —á–µ—Ä–µ–∑ Express.js —Å–µ—Ä–≤–µ—Ä. –ü—Ä–æ–µ–∫—Ç –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–±–æ—Ç—ñ –∑ MongoDB Atlas —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é —Ç–∞ –¥–æ–¥–∞—î –Ω–æ–≤—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –∑ –≤–µ–ª–∏–∫–∏–º–∏ –¥–∞–Ω–∏–º–∏.

## **–ù–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å** ‚≠ê

### **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫—É—Ä—Å–æ—Ä—ñ–≤ —É –º–æ–¥–µ–ª—è—Ö** üìä

**UserModel.getAllWithCursor():**
```javascript
static async getAllWithCursor() {
  const cursor = db.collection('users').find({});
  const users = [];
  
  // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∫—É—Ä—Å–æ—Ä –¥–ª—è —ñ—Ç–µ—Ä–∞—Ü—ñ—ó –±–µ–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –¥–∞–Ω–∏—Ö —É –ø–∞–º'—è—Ç—å
  await cursor.forEach(user => {
    users.push(user);
  });
  
  return users;
}
```

**ArticleModel.getAllWithCursor():**
```javascript
static async getAllWithCursor() {
  const cursor = db.collection('articles').find({}).sort({ createdAt: -1 });
  const articles = [];
  
  // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∫—É—Ä—Å–æ—Ä –¥–ª—è —ñ—Ç–µ—Ä–∞—Ü—ñ—ó –±–µ–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –¥–∞–Ω–∏—Ö —É –ø–∞–º'—è—Ç—å
  await cursor.forEach(article => {
    articles.push(article);
  });
  
  return articles;
}
```

### **–ú–µ—Ç–æ–¥–∏ –ø–æ—à—É–∫—É —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó** üîç

**UserModel.findByEmail()** - –ø–æ—à—É–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ email (–¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó):
```javascript
static async findByEmail(email) {
  const user = await db.collection('users').findOne({ email: email });
  return user;
}
```

**UserModel.getByRole()** - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ —Ä–æ–ª–ª—é:
```javascript
static async getByRole(role) {
  const users = await db.collection('users').find({ role: role }).toArray();
  return users;
}
```

**ArticleModel.getByAuthor()** - —Å—Ç–∞—Ç—Ç—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞:
```javascript
static async getByAuthor(authorId) {
  const articles = await db.collection('articles')
    .find({ authorId: parseInt(authorId) })
    .sort({ createdAt: -1 })
    .toArray();
  return articles;
}
```

**ArticleModel.getByCategory()** - —Å—Ç–∞—Ç—Ç—ñ –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—î—é:
```javascript
static async getByCategory(category) {
  const articles = await db.collection('articles')
    .find({ category: category })
    .sort({ createdAt: -1 })
    .toArray();
  return articles;
}
```

**ArticleModel.getByTags()** - –ø–æ—à—É–∫ —Å—Ç–∞—Ç–µ–π –∑–∞ —Ç–µ–≥–∞–º–∏:
```javascript
static async getByTags(tags) {
  const articles = await db.collection('articles')
    .find({ tags: { $in: Array.isArray(tags) ? tags : [tags] } })
    .sort({ createdAt: -1 })
    .toArray();
  return articles;
}
```

### **–ù–æ–≤—ñ –º–∞—Ä—à—Ä—É—Ç–∏ –∑ –∫—É—Ä—Å–æ—Ä–∞–º–∏** üöÄ

**GET /users/cursor** - –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä
- **–õ–æ–≥—ñ–∫–∞**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `cursor.forEach()` –∑–∞–º—ñ—Å—Ç—å `toArray()`
- **–ü–µ—Ä–µ–≤–∞–≥–∏**: –ï—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –ø–∞–º'—è—Ç—å –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ –≤–µ–ª–∏–∫–∏–º–∏ –∫–æ–ª–µ–∫—Ü—ñ—è–º–∏
- **–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä**: `UserController.getUsersWithCursor()`

**GET /articles/cursor** - –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å—Ç–∞—Ç–µ–π —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä
- **–õ–æ–≥—ñ–∫–∞**: –ö—É—Ä—Å–æ—Ä –∑ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è–º –ø–æ –¥–∞—Ç—ñ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
- **–ü–µ—Ä–µ–≤–∞–≥–∏**: –ü–æ—Ç–æ–∫–æ–≤–∞ –æ–±—Ä–æ–±–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
- **–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä**: `ArticleController.getArticlesWithCursor()`

### **–ê–≥—Ä–µ–≥–∞—Ü—ñ–π–Ω—ñ –∑–∞–ø–∏—Ç–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** üìà

**GET /users/statistics** - –∑–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä**: `UserController.getUsersStatistics()`
- **–ê–≥—Ä–µ–≥–∞—Ü—ñ—è**: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≥–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ç–∞ –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

**GET /articles/statistics** - –∑–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç–∞—Ç–µ–π  
- **–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä**: `ArticleController.getArticlesStatistics()`
- **–ê–≥—Ä–µ–≥–∞—Ü—ñ—è**: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≥–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ç–∞ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–∏—Ö —Å—Ç–∞—Ç–µ–π

---

## **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π** üß™

### **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∫—É—Ä—Å–æ—Ä—ñ–≤**

**–û—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä:**
```bash
GET http://localhost:3000/users/cursor
```

**–û—á—ñ–∫—É–≤–∞–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "success": true,
  "message": "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –æ—Ç—Ä–∏–º–∞–Ω—ñ —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä",
  "data": [
    {
      "_id": "ObjectId",
      "id": 1,
      "name": "John Doe",
      "email": "admin@example.com",
      "role": "admin",
      "age": 35
    }
  ]
}
```

**–û—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç—Ç—ñ —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä:**
```bash
GET http://localhost:3000/articles/cursor
```

### **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–≥—Ä–µ–≥–∞—Ü—ñ–π–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤**

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:**
```bash
GET http://localhost:3000/users/statistics
```

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç–∞—Ç–µ–π:**
```bash
GET http://localhost:3000/articles/statistics
```
```

### **–£—Å–ø–∞–¥–∫–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å** üèóÔ∏è

**–ó –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –ø—Ä–æ–µ–∫—Ç—ñ–≤:**
- **Express.js 5.1.0 —Å–µ—Ä–≤–µ—Ä** –∑ MongoDB Atlas —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é
- **Passport.js –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è** –∑ LocalStrategy (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `UserModel.findByEmail()`)
- **–ü–æ–≤–Ω–∏–π –Ω–∞–±—ñ—Ä CRUD –æ–ø–µ—Ä–∞—Ü—ñ–π** (insertOne/Many, updateOne/Many, replaceOne, deleteOne/Many, find)
- **–ë–µ–∑–ø–µ—á–Ω—ñ —Å–µ—Å—ñ—ó** –∑ file storage —Ç–∞ 13 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ + 11 —Å—Ç–∞—Ç–µ–π  
- **Pug + EJS —à–∞–±–ª–æ–Ω—ñ–∑–∞—Ç–æ—Ä–∏** –∑ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- **–ó–∞—Ö–∏—â–µ–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏** –∑ —Ä–æ–ª—è–º–∏ (admin, editor, moderator, user)
- **–ú–µ—Ç–æ–¥–∏ –ø–æ—à—É–∫—É**: `getByRole()`, `getByAuthor()`, `getByCategory()`, `getByTags()`

### **–¢–µ—Å—Ç–æ–≤—ñ –∞–∫–∞—É–Ω—Ç–∏**
- `admin@example.com` / `admin123` - –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø
- `user@example.com` / `user123` - –±–∞–∑–æ–≤–∏–π –¥–æ—Å—Ç—É–ø

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç—É

### üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è –≤–∏–∫–ª–∞–¥–∞—á–∞/—Ç–µ—Å—Ç—É–≤–∞–ª—å–Ω–∏–∫–∞

**–ë–µ–∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–æ–≥–æ MongoDB Atlas - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –≥–æ—Ç–æ–≤—É –ë–î:**

```bash
# 1. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
npm install

# 2. –°—Ç–≤–æ—Ä—ñ—Ç—å .env —Ñ–∞–π–ª –∑ –≥–æ—Ç–æ–≤–∏–º–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏
# Windows (PowerShell):
copy .env.example .env
# Linux/macOS:
cp .env.example .env

# 3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä
npm start
```

**–ì–æ—Ç–æ–≤–æ!** –î–æ–¥–∞—Ç–æ–∫ –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –≥–æ—Ç–æ–≤–æ—é –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö (13 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ + 11 —Å—Ç–∞—Ç–µ–π)
- –°–µ—Ä–≤–µ—Ä: http://localhost:3000
- –õ–æ–≥—ñ–Ω: `admin@example.com` / `admin123`

---

### ‚öôÔ∏è –ü–æ–≤–Ω–∞ —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—è –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏

**–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –ë–î (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è/—Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è):**

### 1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
```bash
npm install
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è MongoDB Atlas

**üéØ –í–ê–†–Ü–ê–ù–¢ –ê: –ì–û–¢–û–í–ê –ë–î (—Ç—ñ–ª—å–∫–∏ —á–∏—Ç–∞–Ω–Ω—è - –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏)**
```bash
# –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø—ñ—é–π—Ç–µ —Ñ–∞–π–ª - –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∂–µ –≥–æ—Ç–æ–≤—ñ
# Windows (PowerShell):
copy .env.example .env
# Linux/macOS:
cp .env.example .env
```

**üìö –í–ê–†–Ü–ê–ù–¢ –ë: –í–õ–ê–°–ù–ê –ë–î (–ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø - –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏)**

1. **–°—Ç–≤–æ—Ä—ñ—Ç—å –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ [MongoDB Atlas](https://www.mongodb.com/atlas)**
2. **–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –∫–ª–∞—Å—Ç–µ—Ä** (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π M0 Sandbox)
3. **–ù–∞–ª–∞—à—Ç—É–π—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ –º–µ—Ä–µ–∂—ñ:** –¥–æ–¥–∞–π—Ç–µ `0.0.0.0/0` (–≤—Å—ñ IP)
4. **–°—Ç–≤–æ—Ä—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö** –∑ –ø—Ä–∞–≤–∞–º–∏ —á–∏—Ç–∞–Ω–Ω—è/–∑–∞–ø–∏—Å—É
5. **–û—Ç—Ä–∏–º–∞–π—Ç–µ connection string** —á–µ—Ä–µ–∑ "Connect" ‚Üí "Connect your application"

6. **–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ .env —Ñ–∞–π–ª:**
```env
# –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à –≤–ª–∞—Å–Ω–∏–π URI –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É
MONGODB_URI=mongodb+srv://your_username:your_password@your_cluster.mongodb.net/?retryWrites=true&w=majority
DB_NAME=blog
SESSION_SECRET=your-secure-secret-key
PORT=3000
```

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
npm start
```

**üöÄ –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:**
- –ü—ñ–¥–∫–ª—é—á–∏—Ç—å—Å—è –¥–æ MongoDB Atlas
- –°—Ç–≤–æ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–∏—Ö `blog`
- –î–æ–¥–∞—Å—Ç—å 13 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ 11 —Å—Ç–∞—Ç–µ–π

**‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û:** –ë–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ .env —Ñ–∞–π–ª—É –¥–æ–¥–∞—Ç–æ–∫ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è!

–°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞: **http://localhost:3000**

---

## **–¢–µ—Ö–Ω—ñ—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è** üìã

### **–ö–ª—é—á–æ–≤—ñ —Ñ–∞–π–ª–∏ –¥–ª—è –∫—É—Ä—Å–æ—Ä—ñ–≤ —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó**

#### **–ú–æ–¥–µ–ª—ñ –∑ –Ω–æ–≤–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏:**
- `src/models/User.mjs` - –º–µ—Ç–æ–¥–∏ `getAllWithCursor()`, `getStatistics()`, `findByEmail()`, `getByRole()`
- `src/models/Article.mjs` - –º–µ—Ç–æ–¥–∏ `getAllWithCursor()`, `getStatistics()`, `getByAuthor()`, `getByCategory()`, `getByTags()`

#### **–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏ –∑ –Ω–æ–≤–æ—é –ª–æ–≥—ñ–∫–æ—é:**
- `src/controllers/UserController.mjs` - `getUsersWithCursor()`, `getUserStatistics()`
- `src/controllers/ArticleController.mjs` - `getArticlesWithCursor()`, `getArticleStatistics()`

#### **–ú–∞—Ä—à—Ä—É—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:**
- `src/routes/users.mjs` - —Ä–æ—É—Ç–∏ `/cursor` —Ç–∞ `/statistics`
- `src/routes/articles.mjs` - —Ä–æ—É—Ç–∏ `/cursor` —Ç–∞ `/statistics`

#### **–î–æ–¥–∞—Ç–∫–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:**
- **Passport.js —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è**: `UserModel.findByEmail()` –¥–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö**: –º–µ—Ç–æ–¥–∏ –ø–æ—à—É–∫—É –∑–∞ —Ä–æ–ª—è–º–∏, –∞–≤—Ç–æ—Ä–∞–º–∏, –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏, —Ç–µ–≥–∞–º–∏
- **–ë–µ–∑–ø–µ—á–Ω—ñ —É—Ç–∏–ª—ñ—Ç–∏**: `src/utils/userUtils.mjs` –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ req.user

### **Environment –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è**

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` –∑ —Ñ–∞–π–ª—É `.env.example`:
```bash
# Windows (PowerShell):
copy .env.example .env

# Linux/macOS:
cp .env.example .env
```

#### **–í–º—ñ—Å—Ç —Ñ–∞–π–ª—É .env (—Å–∫–æ–ø—ñ—é–π—Ç–µ –∑ .env.example):**

```env
# –°–µ–∫—Ä–µ—Ç –¥–ª—è –ø—ñ–¥–ø–∏—Å—É —Å–µ—Å—ñ–π (–û–ë–û–í'–Ø–ó–ö–û–í–û –∑–º—ñ–Ω—ñ—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ!)
SESSION_SECRET=your-super-secure-session-secret-here

# –†–µ–∂–∏–º —Ä–æ–±–æ—Ç–∏ (development/production)  
NODE_ENV=development

# –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
PORT=3000

# MongoDB Atlas –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
# –í–ê–†–Ü–ê–ù–¢ 1: –ì–æ—Ç–æ–≤–∞ –ë–î –∞–≤—Ç–æ—Ä–∞ (readonly - –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è/–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏)
MONGODB_URI=mongodb+srv://student_readonly:simple_password_123@cluster0.3cgin6c.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0
DB_NAME=blog

# –í–ê–†–Ü–ê–ù–¢ 2: –í–ª–∞—Å–Ω–∞ –ë–î (–ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø - –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏)
# –†–æ–∑–∫–æ–º–µ–Ω—Ç—É–π—Ç–µ —Ç–∞ –∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à—ñ –¥–∞–Ω—ñ:
# MONGODB_URI=mongodb+srv://your_username:your_password@your_cluster.mongodb.net/?retryWrites=true&w=majority&appName=YourApp
# DB_NAME=blog
```

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö:**
- `SESSION_SECRET` - —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è –ø—ñ–¥–ø–∏—Å—É —Å–µ—Å—ñ–π
- `NODE_ENV` - —Ä–µ–∂–∏–º —Ä–æ–±–æ—Ç–∏ (`development` –∞–±–æ `production`)
- `PORT` - –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 3000)
- `MONGODB_URI` - connection string –¥–æ MongoDB Atlas
- `DB_NAME` - –Ω–∞–∑–≤–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö (`blog`)

**üéØ –î–ª—è —à–≤–∏–¥–∫–æ–≥–æ –∑–∞–ø—É—Å–∫—É:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –í–ê–†–Ü–ê–ù–¢ 1 (–≥–æ—Ç–æ–≤–∞ –ë–î) - –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø—ñ—é–π—Ç–µ .env.example –≤ .env –±–µ–∑ –∑–º—ñ–Ω.

**üìö –î–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –í–ê–†–Ü–ê–ù–¢ 2 - —Å—Ç–≤–æ—Ä—ñ—Ç—å –≤–ª–∞—Å–Ω–∏–π MongoDB Atlas –∫–ª–∞—Å—Ç–µ—Ä —Ç–∞ –∑–∞–º—ñ–Ω—ñ—Ç—å –¥–∞–Ω—ñ.

### **–û—Å–Ω–æ–≤–Ω—ñ API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏**

#### **–ö—É—Ä—Å–æ—Ä–∏:**
- `GET /users/cursor` - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —á–µ—Ä–µ–∑ cursor.forEach()
- `GET /articles/cursor` - —Å—Ç–∞—Ç—Ç—ñ —á–µ—Ä–µ–∑ cursor.forEach()

#### **–ê–≥—Ä–µ–≥–∞—Ü—ñ—è:**
- `GET /users/statistics` - –∑–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- `GET /articles/statistics` - –∑–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç–∞—Ç–µ–π

---

## **–î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –Ω–æ–≤–∏—Ö –º–∞—Ä—à—Ä—É—Ç—ñ–≤** üìã

### **1. –ú–∞—Ä—à—Ä—É—Ç–∏ –∑ –∫—É—Ä—Å–æ—Ä–∞–º–∏**

#### **GET /users/cursor - –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä**

**–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä**: `UserController.getUsersWithCursor()`

**–õ–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏:**
- –°—Ç–≤–æ—Ä—é—î –∫—É—Ä—Å–æ—Ä –¥–ª—è –∫–æ–ª–µ–∫—Ü—ñ—ó `users`
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `cursor.forEach()` –¥–ª—è —ñ—Ç–µ—Ä–∞—Ü—ñ—ó
- –û–±—Ä–æ–±–ª—è—î –∫–æ–∂–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç –æ–∫—Ä–µ–º–æ –±–µ–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –≤ –ø–∞–º'—è—Ç—å
- –ü–æ–≤–µ—Ä—Ç–∞—î –º–∞—Å–∏–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ –º–µ—Ç–∞–¥–∞–Ω–∏–º–∏

**–ü–µ—Ä–µ–≤–∞–≥–∏ –ø–µ—Ä–µ–¥ –∑–≤–∏—á–∞–π–Ω–∏–º find():**
- –ó–º–µ–Ω—à–µ–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è RAM –ø—Ä–∏ –≤–µ–ª–∏–∫–∏—Ö –∫–æ–ª–µ–∫—Ü—ñ—è—Ö
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ–±—Ä–æ–±–∫–∏ –º—ñ–ª—å–π–æ–Ω—ñ–≤ –∑–∞–ø–∏—Å—ñ–≤
- –ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å–æ–º —ñ—Ç–µ—Ä–∞—Ü—ñ—ó

#### **GET /articles/cursor - –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Å—Ç–∞—Ç–µ–π —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä**

**–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä**: `ArticleController.getArticlesWithCursor()`

**–õ–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏:**
- –°—Ç–≤–æ—Ä—é—î –∫—É—Ä—Å–æ—Ä –∑ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è–º `{ createdAt: -1 }`
- –Ü—Ç–µ—Ä–∞—Ü—ñ—è —á–µ—Ä–µ–∑ `forEach()` –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–∫—Ä–∏–≤–∞—î –∫—É—Ä—Å–æ—Ä –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è

### **2. –ú–∞—Ä—à—Ä—É—Ç–∏ –∑ –∞–≥—Ä–µ–≥–∞—Ü—ñ—î—é**

#### **GET /users/statistics - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**

**–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä**: `UserController.getUsersStatistics()`
**–õ–æ–≥—ñ–∫–∞**: –ê–≥—Ä–µ–≥–∞—Ü—ñ—è –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –∑–∞–≥–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ç–∞ –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

#### **GET /articles/statistics - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç–∞—Ç–µ–π**

**–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä**: `ArticleController.getArticlesStatistics()`  
**–õ–æ–≥—ñ–∫–∞**: –ê–≥—Ä–µ–≥–∞—Ü—ñ—è –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –∑–∞–≥–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ç–∞ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–∏—Ö —Å—Ç–∞—Ç–µ–π

---

## **–î–µ—Ç–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è** üß™

### **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ curl**

#### **1. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∫—É—Ä—Å–æ—Ä—ñ–≤**

**–¢–µ—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä:**
```bash
# –ë–∞–∑–æ–≤–∏–π –∑–∞–ø–∏—Ç
curl -X GET "http://localhost:3000/users/cursor" \
  -H "Accept: application/json" \
  -H "Content-Type: application/json"

# –ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—î—é (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)  
curl -X GET "http://localhost:3000/users/cursor" \
  -H "Accept: application/json" \
  -b "connect.sid=s%3A..."
```

**–¢–µ—Å—Ç —Å—Ç–∞—Ç–µ–π —á–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä:**
```bash
curl -X GET "http://localhost:3000/articles/cursor" \
  -H "Accept: application/json"
```
```

#### **2. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó**

**–¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:**
```bash
curl -X GET "http://localhost:3000/users/statistics" \
  -H "Accept: application/json" \
  -v
```

**–¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å—Ç–∞—Ç–µ–π:**
```bash 
curl -X GET "http://localhost:3000/articles/statistics" \
  -H "Accept: application/json"
```





---

## **–ü–µ—Ä–µ–≤–∞–≥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫—É—Ä—Å–æ—Ä—ñ–≤ —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó** ‚ö°

### **–ö—É—Ä—Å–æ—Ä–∏ vs toArray()**
- **–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø–∞–º'—è—Ç—ñ**: cursor.forEach() –æ–±—Ä–æ–±–ª—è—î –¥–æ–∫—É–º–µ–Ω—Ç–∏ –ø–æ –æ–¥–Ω–æ–º—É
- **–í–µ–ª–∏–∫—ñ –∫–æ–ª–µ–∫—Ü—ñ—ó**: –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤—Å—ñ –¥–∞–Ω—ñ –≤ –ø–∞–º'—è—Ç—å –æ–¥—Ä–∞–∑—É
- **–ü–æ—Ç–æ–∫–æ–≤–∞ –æ–±—Ä–æ–±–∫–∞**: –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑—É–ø–∏–Ω–∫–∏ —Ç–∞ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è

### **–ê–≥—Ä–µ–≥–∞—Ü—ñ–π–Ω—ñ –∑–∞–ø–∏—Ç–∏**
- **–û–ø–µ—Ä–∞—Ç–æ—Ä–∏ `$group`**: –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –∑–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—è–º–∏
- **–§—É–Ω–∫—Ü—ñ—ó `$sum`, `$avg`**: –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
- **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –≤ MongoDB, –∞ –Ω–µ –≤ Node.js
- **–ì–Ω—É—á–∫—ñ—Å—Ç—å**: —Å–∫–ª–∞–¥–Ω—ñ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ –∑–∞–ø–∏—Ç–∏ —á–µ—Ä–µ–∑ pipeline

---

## **–í–∏—Å–Ω–æ–≤–∫–∏** üéØ

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î:
1. **–ï—Ñ–µ–∫—Ç–∏–≤–Ω—É —Ä–æ–±–æ—Ç—É –∑ –∫—É—Ä—Å–æ—Ä–∞–º–∏** –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö
2. **–ê–≥—Ä–µ–≥–∞—Ü—ñ–π–Ω—ñ –∑–∞–ø–∏—Ç–∏ MongoDB** –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
3. **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ Express.js** –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è RESTful API
4. **–ü—Ä–∞–∫—Ç–∏—á–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è** MongoDB Driver 6.20.0

**–û—Å–Ω–æ–≤–Ω—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è:**
- ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ cursor-based —ñ—Ç–µ—Ä–∞—Ü—ñ—é –≤ –º–æ–¥–µ–ª—è—Ö
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ –∞–≥—Ä–µ–≥–∞—Ü—ñ–π–Ω—ñ pipeline –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ –î–æ–¥–∞–Ω–æ API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ
- ‚úÖ –ù–∞–ø–∏—Å–∞–Ω–æ –ø–æ–≤–Ω—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –∑ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏